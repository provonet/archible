---
- hosts: all

  vars:
    ansible_python_interpreter: /usr/bin/python2
    hostname: myarchbox
    domain: mydomain.net
    root_password: secret
    locale:
      region: Europe
      city: Amsterdam

  vars_prompt:
    - name: "root_password"
      prompt: "root password for the new installation"
      private: yes
      confirm: yes
      encrypt: "sha512_crypt"
      salt_size: 7

  pre_tasks:
  - name: run galaxy
    local_action: command ansible-galaxy install -r requirements.yml --roles-path roles --force
    register: fetch_roles

  tasks:
  - include_role:
      name: arch-bootstrap
      static: no
    ignore_errors: True
    when:
      - fetch_roles.changed

